#!/bin/sh
echo 'ğŸ” Tikrinamas kodas prieÅ¡ commit...'

# âœ… 1ï¸âƒ£ Tikriname sintaksÄ—s klaidas
python -m py_compile modules/*.py
EXIT_CODE=$?
if [ -z "$EXIT_CODE" ]; then
    echo 'âš ï¸ Ä®spÄ—jimas: EXIT_CODE yra tuÅ¡Äias, nustatoma reikÅ¡mÄ— 1'
    EXIT_CODE=1
fi
if [ "$EXIT_CODE" -ne 0 ]; then
    echo 'âŒ Klaida: Kodas turi sintaksÄ—s klaidÅ³! Commit sustabdytas.'
    exit 1
fi
echo 'âœ… Kodas sintaksiÅ¡kai teisingas.'

# âœ… 2ï¸âƒ£ Vykdome automatinÄ¯ testavimÄ…
echo 'ğŸš€ Vykdomas unittest testavimas...'
PYTHONIOENCODING=utf-8 python -m unittest discover -s tests
TEST_EXIT_CODE=$?

if [ "$TEST_EXIT_CODE" -ne 0 ]; then
    echo 'âŒ Klaida: Testai nepraÄ—jo! Commit sustabdytas.'
    exit 1
fi
echo 'âœ… Visi testai sÄ—kmingai Ä¯vykdyti!'

exit 0
